{% extends 'base.html' %}

{% block head_title %}
wowowow1
{% endblock head_title %}

{% block content %}
<div class="row text-center">
    <div class="col">
        <h1> Welcome to TweetClone </h1>
    </div>
</div>

<div class="row" id="tweets">
    Loading...
</div>

<script>

    function handleDidLike(tweetId, currentCount) {
        console.log(tweetId, currentCount)
    }

    function formatTweetElement(tweet) {
        return `<div class='col-12 col-md-10 mx-auto border rounded py-3 mb-4' id='tweet-${tweet.id}'>
                    <p>
                        ${tweet.content}
                        <div class='btn-group'>
                            <button class='btn btn-primary btn-sm' onclick='handleDidLike(${tweet.id}, ${tweet.likes})'> ${tweet.likes} Likes</button>
                        </div>
                    </p>
                </div>`
    }

    async function getAllTweets () {
        const response = await fetch('/tweets')
        const tweetData = await response.json()
        console.log(tweetData.response)
        return tweetData.response  
    }

    const tweetElement = document.getElementById('tweets')
    
    getAllTweets().then(tweets => {
        tweetElement.innerHTML = ''
        tweets.forEach(tweet => {
            const tagItem = formatTweetElement(tweet)
            tweetElement.innerHTML += tagItem
        });
    })
    
</script>
{% endblock content %}
